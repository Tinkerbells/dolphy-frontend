/**
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–º–æ–¥–∑–∏ —Ñ–ª–∞–≥–∞ Unicode –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã/—è–∑—ã–∫–∞
 * @param countryCode - –ö–æ–¥ —è–∑—ã–∫–∞ ISO 639-1 (–Ω–∞–ø—Ä–∏–º–µ—Ä, "en", "ru") –∏–ª–∏
 *                      –ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã ISO 3166-1 alpha-2 (–Ω–∞–ø—Ä–∏–º–µ—Ä, "US", "RU")
 * @returns –≠–º–æ–¥–∑–∏ —Ñ–ª–∞–≥–∞ Unicode –∏–ª–∏ undefined, –µ—Å–ª–∏ –∫–æ–¥ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
 */
export function getCountryFlag(countryCode: string): string | undefined {
  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
  const code = countryCode.trim().toUpperCase()

  // –ö–∞—Ä—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–æ–¥–æ–≤ —è–∑—ã–∫–æ–≤ –∫–æ–¥–∞–º —Å—Ç—Ä–∞–Ω –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–ª—É—á–∞–µ–≤
  const languageToCountry: Record<string, string> = {
    EN: 'GB', // –ê–Ω–≥–ª–∏–π—Å–∫–∏–π -> –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è
    RU: 'RU', // –†—É—Å—Å–∫–∏–π -> –†–æ—Å—Å–∏—è
    ES: 'ES', // –ò—Å–ø–∞–Ω—Å–∫–∏–π -> –ò—Å–ø–∞–Ω–∏—è
    FR: 'FR', // –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π -> –§—Ä–∞–Ω—Ü–∏—è
    DE: 'DE', // –ù–µ–º–µ—Ü–∫–∏–π -> –ì–µ—Ä–º–∞–Ω–∏—è
    IT: 'IT', // –ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π -> –ò—Ç–∞–ª–∏—è
    ZH: 'CN', // –ö–∏—Ç–∞–π—Å–∫–∏–π -> –ö–∏—Ç–∞–π
    JA: 'JP', // –Ø–ø–æ–Ω—Å–∫–∏–π -> –Ø–ø–æ–Ω–∏—è
    KO: 'KR', // –ö–æ—Ä–µ–π—Å–∫–∏–π -> –Æ–∂–Ω–∞—è –ö–æ—Ä–µ—è
    AR: 'SA', // –ê—Ä–∞–±—Å–∫–∏–π -> –°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è
    HI: 'IN', // –•–∏–Ω–¥–∏ -> –ò–Ω–¥–∏—è
    PT: 'PT', // –ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π -> –ü–æ—Ä—Ç—É–≥–∞–ª–∏—è
    // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
  }

  // –ï—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —è–∑—ã–∫–æ–≤–æ–π –∫–æ–¥, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –µ–≥–æ –≤ –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã
  const countryCodeToUse = languageToCountry[code] || code

  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º undefined –¥–ª—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
  if (countryCodeToUse.length !== 2) {
    return undefined
  }

  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã –≤ —ç–º–æ–¥–∑–∏ —Ñ–ª–∞–≥–∞ Unicode
  // –ö–∞–∂–¥—ã–π —Ñ–ª–∞–≥ Unicode —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 2 —Å–∏–º–≤–æ–ª–æ–≤ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
  // –ö–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—É—Ç–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
  // —Å–º–µ—â–µ–Ω–∏—è 127397 (0x1F1A5) –∫ ASCII-–∫–æ–¥—É –ø—Ä–æ–ø–∏—Å–Ω–æ–π –±—É–∫–≤—ã
  try {
    const codePoints = [...countryCodeToUse].map(char =>
      char.charCodeAt(0) + 127397,
    )

    return String.fromCodePoint(...codePoints)
  }
  catch (error) {
    console.error(error)
    return undefined
  }
}

// –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
// getCountryFlag("en") => "üá¨üáß"
// getCountryFlag("ru") => "üá∑üá∫"
// getCountryFlag("us") => "üá∫üá∏"
